Author: Sven Joachim <svenjoac@gmx.de>
Description: Fixes for CVE-2019-17595, CVE-2020-19185, CVE-2020-19187, CVE-2020-19188
Bug-Debian: https://bugs.debian.org/942401
Bug: https://lists.gnu.org/archive/html/bug-ncurses/2019-10/msg00013.html
Bug: https://lists.gnu.org/archive/html/bug-ncurses/2019-10/msg00018.html
Forwarded: not-needed
Last-Update: 2023-09-28

---
 progs/dump_entry.c |    5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

Index: ncurses-5.9+20140913/progs/dump_entry.c
===================================================================
--- ncurses-5.9+20140913.orig/progs/dump_entry.c	2022-06-27 19:51:41.852849399 +0200
+++ ncurses-5.9+20140913/progs/dump_entry.c	2022-06-27 19:51:41.848849393 +0200
@@ -843,7 +843,8 @@
 				*d++ = '\\';
 				*d = ':';
 			    } else if (*d == '\\') {
-				*++d = *s++;
+				if ((*++d = *s++) == '\0')
+				    break;
 			    }
 			    d++;
 			}
@@ -1097,7 +1098,7 @@
 
     if (VALID_STRING(mapping)) {
 	int n = 0;
-	while (mapping[n] != '\0') {
+	while (mapping[n] != '\0' && mapping[n + 1] != '\0') {
 	    if (isLine(mapping[n]) &&
 		mapping[n] != mapping[n + 1]) {
 		result = FALSE;
